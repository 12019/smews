/* Copyright 2009 Alex Negrea

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 ========================================================================

 Optimized for minimal code size.
 */



#include "md5.h"

static void md5_transform(struct md5_context*);

static CONST_VAR(uint8_t,Kr[64]) =
{
  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,  7, 12, 17, 22,
  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,  5,  9, 14, 20,
  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,  4, 11, 16, 23,
  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21,  6, 10, 15, 21
};



static CONST_VAR(uint32_t,consts[64]) = {
	0xD76AA478, 0xE8C7B756, 0x242070DB, 0xC1BDCEEE,
	0xF57C0FAF, 0x4787C62A, 0xA8304613, 0xFD469501,
	0x698098D8, 0x8B44F7AF, 0xFFFF5BB1, 0x895CD7BE,
	0x6B901122, 0xFD987193, 0xA679438E, 0x49B40821,

	0xF61E2562, 0xC040B340, 0x265E5A51, 0xE9B6C7AA,
	0xD62F105D, 0x02441453, 0xD8A1E681, 0xE7D3FBC8,
	0x21E1CDE6, 0xC33707D6, 0xF4D50D87, 0x455A14ED,
	0xA9E3E905, 0xFCEFA3F8, 0x676F02D9, 0x8D2A4C8A,

	0xFFFA3942, 0x8771F681, 0x6D9D6122, 0xFDE5380C,
	0xA4BEEA44, 0x4BDECFA9, 0xF6BB4B60, 0xBEBFBC70,
	0x289B7EC6, 0xEAA127FA, 0xD4EF3085, 0x04881D05,
	0xD9D4D039, 0xE6DB99E5, 0x1FA27CF8, 0xC4AC5665,

	0xF4292244, 0x432AFF97, 0xAB9423A7, 0xFC93A039,
	0x655B59C3, 0x8F0CCC92, 0xFFEFF47D, 0x85845DD1,
	0x6FA87E4F, 0xFE2CE6E0, 0xA3014314, 0x4E0811A1,
	0xF7537E82, 0xBD3AF235, 0x2AD7D2BB, 0xEB86D391
};



/*
* MD5 basic transformation. Transforms state based on a 64-byte block.
*/
static void md5_transform(struct md5_context *ctx){


	uint8_t* p = ctx->buffer;
	uint32_t *state = ctx->state;
	uint32_t block[16];

	uint32_t A, B, C, D;
	uint8_t i;


	for(i = 0; i < 16; ++i) {
	    uint32_t tmp =  *p++;
	    tmp |= *p++ << 8;
	    tmp |= *p++ << 16;
	    tmp |= *p++ << 24;
	    block[i] = tmp;
	}

	A = state[0];
	B = state[1];
	C = state[2];
	D = state[3];

	for(i = 0; i < 64; i++) {
		uint32_t f, tmp;
		uint32_t g;

		if (i < 16) {
		  f = (D^(B&(C^D)));
		  g = i;
		} else if ( i < 32) {
		  f = (C^(D&(B^C)));
		  g = (5*i + 1) & 15;
		} else if (i < 48) {
		  f = (B^C^D);
		  g = (3*i + 5) & 15;
		} else {
		  f = (C^(B|(~D)));
		  g = (7*i) & 15;
		}

		tmp = D;
		D = C;
		C = B;
		B = B + ROL(Kr[i], (A+f+consts[i]+block[g]));
		A = tmp;
	}


	state[0] += A;
	state[1] += B;
	state[2] += C;
	state[3] += D;



}

/* MD5 block update operation. Continues an MD5 message-digest
* operation, processing another message block, and updating the context. */
void md5_update(struct md5_context *ctx, const uint8_t* data, uint16_t len){

	uint8_t *p = ctx->buffer;
	uint32_t i = ctx->count & 63ULL;
	ctx->count +=len;


	while (len--) {

		p[i++] = *data++;
		if (i == 64) {
		  md5_transform(ctx);
		  i = 0;
		}

	}


}

/*
* MD5 finalization. Ends an MD5 message-digest operation, writing the
* the message digest and zeroizing the context.
*/
void md5_digest(struct md5_context *ctx){

	uint8_t i;

	uint8_t *p = ctx->buffer;
	uint64_t cnt = ctx->count * 8;

    md5_update(ctx, (uint8_t*)"\x80", 1);

	while(( (ctx->count) & 63) != 56) {
		md5_update(ctx, (uint8_t*)"\0", 1);

	}

	for (i = 0; i < 8; ++i) {
		uint8_t tmp = cnt >> (i * 8);
		md5_update(ctx, &tmp, 1);
	}

	for (i = 0; i < 4; i++) {
		uint32_t tmp = ctx->state[i];
		*p++ = tmp;
		*p++ = tmp >> 8;
		*p++ = tmp >> 16;
		*p++ = tmp >> 24;
	}


	/* copy_bytes(ctx->buffer,r,0,MD5_SIZE); */

}


/* MD5 initialization. Begins an MD5 operation, writing a new context */
void md5_init(struct md5_context *ctx){

	ctx->count = 0ULL;

	ctx->state[0] = 0x67452301;
	ctx->state[1] = 0xefcdab89;
	ctx->state[2] = 0x98badcfe;
	ctx->state[3] = 0x10325476;


	/* for (i = 0; i < 64 ; i++) ctx->buffer[i] = 0; */



}

void md5_clone(struct md5_context *src, struct md5_context *dst){

	uint8_t i ;
	for(i = 0; i < 64 ; i++){
		dst->buffer[i] = src->buffer[i];
	}

	for(i = 0; i < 4 ; i++){
		dst->state[i] = src->state[i];
	}

	dst->count = src->count;

}

/*

int main(){

	uint16_t i;

	uint8_t eat[809] = {0x01,0x00,0x00,0xc7,0x03,0x01,0x4a,0x6f,0x0c,0xb7,0xf6,0x52,0x54,0xbb,0x91,0x00,0xbe,0xee,0xd2,0xff,0xaf,0x26,0xb8,0x05,0x70,0xb7,0x6a,0x7d,0xd8,0x3e,0xda,0x50,0xc5,0xd0,0x91,0x72,0x13,0x6b,0x00,0x00,0x5a,0xc0,0x14,0xc0,0x0a,0x00,0x39,0x00,0x38,0x00,0x88,0x00,0x87,0xc0,0x0f,0xc0,0x05,0x00,0x35,0x00,0x84,0xc0,0x12,0xc0,0x08,0x00,0x16,0x00,0x13,0xc0,0x0d,0xc0,0x03,0x00,0x0a,0xc0,0x13,0xc0,0x09,0x00,0x33,0x00,0x32,0x00,0x9a,0x00,0x99,0x00,0x45,0x00,0x44,0xc0,0x0e,0xc0,0x04,0x00,0x2f,0x00,0x96,0x00,0x41,0x00,0x07,0xc0,0x11,0xc0,0x07,0xc0,0x0c,0xc0,0x02,0x00,0x05,0x00,0x04,0x00,0x15,0x00,0x12,0x00,0x09,0x00,0x14,0x00,0x11,0x00,0x08,0x00,0x06,0x00,0x03,0x01,0x00,0x00,0x44,0x00,0x0b,0x00,0x04,0x03,0x00,0x01,0x02,0x00,0x0a,0x00,0x34,0x00,0x32,0x00,0x01,0x00,0x02,0x00,0x03,0x00,0x04,0x00,0x05,0x00,0x06,0x00,0x07,0x00,0x08,0x00,0x09,0x00,0x0a,0x00,0x0b,0x00,0x0c,0x00,0x0d,0x00,0x0e,0x00,0x0f,0x00,0x10,0x00,0x11,0x00,0x12,0x00,0x13,0x00,0x14,0x00,0x15,0x00,0x16,0x00,0x17,0x00,0x18,0x00,0x19,0x00,0x23,0x00,0x00,0x02,0x00,0x00,0x2e,0x03,0x01,0x4a,0x0a,0xaa,0x64,0xf5,0x7e,0x64,0xdc,0x31,0xba,0x8f,0x46,0xe3,0xbf,0xfd,0xec,0x1d,0x0a,0x64,0x1a,0xd7,0x4a,0xd3,0x13,0xc3,0xbb,0x53,0x84,0x41,0x02,0xc7,0xa5,0x00,0xc0,0x02,0x00,0x00,0x06,0x00,0x0b,0x00,0x02,0x01,0x00,0x0b,0x00,0x01,0xde,0x00,0x01,0xdb,0x00,0x01,0xd8,0x30,0x82,0x01,0xd4,0x30,0x82,0x01,0x7c,0x02,0x01,0x04,0x30,0x09,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x04,0x01,0x30,0x6b,0x31,0x0b,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0f,0x30,0x0d,0x06,0x03,0x55,0x04,0x08,0x13,0x06,0x46,0x72,0x61,0x6e,0x63,0x65,0x31,0x0e,0x30,0x0c,0x06,0x03,0x55,0x04,0x07,0x13,0x05,0x4c,0x69,0x6c,0x6c,0x65,0x31,0x18,0x30,0x16,0x06,0x03,0x55,0x04,0x0a,0x13,0x0f,0x20,0x43,0x41,0x20,0x45,0x43,0x43,0x20,0x54,0x45,0x53,0x54,0x49,0x4e,0x47,0x31,0x0f,0x30,0x0d,0x06,0x03,0x55,0x04,0x0b,0x13,0x06,0x43,0x41,0x20,0x45,0x43,0x43,0x31,0x10,0x30,0x0e,0x06,0x03,0x55,0x04,0x03,0x13,0x07,0x45,0x43,0x44,0x48,0x20,0x43,0x41,0x30,0x1e,0x17,0x0d,0x30,0x39,0x30,0x37,0x31,0x33,0x31
,0x32,0x31,0x32,0x32,0x39,0x5a,0x17,0x0d,0x30,0x39,0x30,0x38,0x31,0x32,0x31,0x32,0x31,0x32,0x32,0x39,0x5a,0x30,0x81,0x83,0x31,0x0b,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0d,0x30,0x0b,0x06,0x03,0x55,0x04,0x08,0x0c,0x04,0x4e,0x4f,0x52,0x44,0x31,0x0e,0x30,0x0c,0x06,0x03,0x55,0x04,0x07,0x0c,0x05,0x4c,0x69,0x6c,0x6c,0x65,0x31,0x13,0x30,0x11,0x06,0x03,0x55,0x04,0x0a,0x0c,0x0a,0x49,0x4e,0x52,0x49,0x41,0x20,0x43,0x6f,0x72,0x70,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x0b,0x0c,0x09,0x74,0x6c,0x73,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x03,0x0c,0x09,0x74,0x6c,0x73,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x31,0x18,0x30,0x16,0x06,0x09,0x2a,0x86,0x48,0x86,0xf7,0x0d,0x01,0x09,0x01,0x16,0x09,0x6e,0x75,0x40,0x61,0x72,0x65,0x2e,0x72,0x6f,0x30,0x59,0x30,0x13,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x02,0x01,0x06,0x08,0x2a,0x86,0x48,0xce,0x3d,0x03,0x01,0x07,0x03,0x42,0x00,0x04,0x5b,0x5d,0xee,0x74,0xd4,0x63,0x63,0x2f,0x1c,0x19,0x8f,0xc0,0x7c,0x16,0x01,0x7b,0xa0,0x26,0xa5,0x2c,0x98,0x55,0xb3,0x2e,0xae,0x43,0xcc,0xee,0xe2,0xdf,0x6f,0x35,0xd6,0xfe,0x4f,0x9d,0x45,0x94,0x0d,0x16,0x2a,0x4d,0x35,0xff,0xbb,0x56,0x33,0x0e,0x52,0xb3,0x34,0x35,0x78,0xa9,0x60,0xa0,0x92,0xc4,0xe2,0xbb,0xdf,0xb8,0x0d,0x2f,0x30,0x09,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x04,0x01,0x03,0x47,0x00,0x30,0x44,0x02,0x20,0x3f,0xa0,0x76,0x48,0xd1,0xb8,0xde,0xa0,0x59,0x34,0xfb,0x21,0xc9,0x7b,0x56,0xd7,0x8a,0x31,0xbc,0x7f,0x62,0x9b,0x85,0x40,0xf7,0xf7,0x9b,0x82,0x93,0x26,0xc2,0x74,0x02,0x20,0x42,0x76,0x25,0xa7,0xba,0xd3,0x50,0x28,0x79,0xc2,0xf1,0xfe,0x14,0x4b,0x40,0x99,0x46,0x89,0xce,0xae,0xfd,0x69,0x0f,0x41,0x5b,0x24,0x8f,0x25,0xba,0xe0,0x6f,0xe7,0x0e,0x00,0x00,0x00,0x10,0x00,0x00,0x42,0x41,0x04,0x99,0xa3,0x2c,0x15,0x92,0x89,0x0f,0xad,0x1e,0x6c,0x98,0xf0,0xda,0x0b,0x24,0xb3,0x2a,0x37,0xb7,0x9f,0x48,0xe9,0x52,0x24,0x4e,0xd7,0x46,0xcb,0xe1,0xf1,0x18,0x3d,0xdf,0xe8,0x41,0xd5,0x92,0x17,0x99,0xe8,0xc4,0x8e,0x28,0x7c,0x4e,0x39,0x54,0x28,0x57,0x5c,0xc7,0x10,0x6d,0x07,0x03,0x06,0x99,0x5c,0xa2,0xc0,0xc9,0x14,0x25,0xb0};
	uint8_t string[1618] = "010000c703014a6f0cb7f65254bb9100beeed2ffaf26b80570b76a7dd83eda50c5d09172136b00005ac014c00a0039003800880087c00fc00500350084c012c00800160013c00dc003000ac013c00900330032009a009900450044c00ec004002f009600410007c011c007c00cc002000500040015001200090014001100080006000301000044000b000403000102000a00340032000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019002300000200002e03014a0aaa64f57e64dc31ba8f46e3bffdec1d0a641ad74ad313c3bb53844102c7a500c002000006000b000201000b0001de0001db0001d8308201d43082017c020104300906072a8648ce3d0401306b310b3009060355040613024652310f300d060355040813064672616e6365310e300c060355040713054c696c6c6531183016060355040a130f204341204543432054455354494e47310f300d060355040b13064341204543433110300e0603550403130745434448204341301e170d3039303731333132313232395a170d3039303831323132313232395a308183310b3009060355040613024652310d300b06035504080c044e4f5244310e300c06035504070c054c696c6c6531133011060355040a0c0a494e52494120436f727031123010060355040b0c09746c732e6c6f63616c3112301006035504030c09746c732e6c6f63616c3118301606092a864886f70d01090116096e75406172652e726f3059301306072a8648ce3d020106082a8648ce3d030107034200045b5dee74d463632f1c198fc07c16017ba026a52c9855b32eae43cceee2df6f35d6fe4f9d45940d162a4d35ffbb56330e52b3343578a960a092c4e2bbdfb80d2f300906072a8648ce3d0401034700304402203fa07648d1b8dea05934fb21c97b56d78a31bc7f629b8540f7f79b829326c2740220427625a7bad3502879c2f1fe144b40994689ceaefd690f415b248f25bae06fe70e00000010000042410499a32c1592890fad1e6c98f0da0b24b32a37b79f48e952244ed746cbe1f1183ddfe841d5921799e8c48e287c4e395428575cc7106d070306995ca2c0c91425b0";
	uint8_t eat1[400] = {0x01,0x00,0x00,0xc7,0x03,0x01,0x4a,0x6f,0x0c,0xb7,0xf6,0x52,0x54,0xbb,0x91,0x00,0xbe,0xee,0xd2,0xff,0xaf,0x26,0xb8,0x05,0x70,0xb7,0x6a,0x7d,0xd8,0x3e,0xda,0x50,0xc5,0xd0,0x91,0x72,0x13,0x6b,0x00,0x00,0x5a,0xc0,0x14,0xc0,0x0a,0x00,0x39,0x00,0x38,0x00,0x88,0x00,0x87,0xc0,0x0f,0xc0,0x05,0x00,0x35,0x00,0x84,0xc0,0x12,0xc0,0x08,0x00,0x16,0x00,0x13,0xc0,0x0d,0xc0,0x03,0x00,0x0a,0xc0,0x13,0xc0,0x09,0x00,0x33,0x00,0x32,0x00,0x9a,0x00,0x99,0x00,0x45,0x00,0x44,0xc0,0x0e,0xc0,0x04,0x00,0x2f,0x00,0x96,0x00,0x41,0x00,0x07,0xc0,0x11,0xc0,0x07,0xc0,0x0c,0xc0,0x02,0x00,0x05,0x00,0x04,0x00,0x15,0x00,0x12,0x00,0x09,0x00,0x14,0x00,0x11,0x00,0x08,0x00,0x06,0x00,0x03,0x01,0x00,0x00,0x44,0x00,0x0b,0x00,0x04,0x03,0x00,0x01,0x02,0x00,0x0a,0x00,0x34,0x00,0x32,0x00,0x01,0x00,0x02,0x00,0x03,0x00,0x04,0x00,0x05,0x00,0x06,0x00,0x07,0x00,0x08,0x00,0x09,0x00,0x0a,0x00,0x0b,0x00,0x0c,0x00,0x0d,0x00,0x0e,0x00,0x0f,0x00,0x10,0x00,0x11,0x00,0x12,0x00,0x13,0x00,0x14,0x00,0x15,0x00,0x16,0x00,0x17,0x00,0x18,0x00,0x19,0x00,0x23,0x00,0x00,0x02,0x00,0x00,0x2e,0x03,0x01,0x4a,0x0a,0xaa,0x64,0xf5,0x7e,0x64,0xdc,0x31,0xba,0x8f,0x46,0xe3,0xbf,0xfd,0xec,0x1d,0x0a,0x64,0x1a,0xd7,0x4a,0xd3,0x13,0xc3,0xbb,0x53,0x84,0x41,0x02,0xc7,0xa5,0x00,0xc0,0x02,0x00,0x00,0x06,0x00,0x0b,0x00,0x02,0x01,0x00,0x0b,0x00,0x01,0xde,0x00,0x01,0xdb,0x00,0x01,0xd8,0x30,0x82,0x01,0xd4,0x30,0x82,0x01,0x7c,0x02,0x01,0x04,0x30,0x09,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x04,0x01,0x30,0x6b,0x31,0x0b,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0f,0x30,0x0d,0x06,0x03,0x55,0x04,0x08,0x13,0x06,0x46,0x72,0x61,0x6e,0x63,0x65,0x31,0x0e,0x30,0x0c,0x06,0x03,0x55,0x04,0x07,0x13,0x05,0x4c,0x69,0x6c,0x6c,0x65,0x31,0x18,0x30,0x16,0x06,0x03,0x55,0x04,0x0a,0x13,0x0f,0x20,0x43,0x41,0x20,0x45,0x43,0x43,0x20,0x54,0x45,0x53,0x54,0x49,0x4e,0x47,0x31,0x0f,0x30,0x0d,0x06,0x03,0x55,0x04,0x0b,0x13,0x06,0x43,0x41,0x20,0x45,0x43,0x43,0x31,0x10,0x30,0x0e,0x06,0x03,0x55,0x04,0x03,0x13,0x07,0x45,0x43,0x44,0x48,0x20,0x43,0x41,0x30,0x1e,0x17,0x0d,0x30,0x39};
	uint8_t eat2[409] = {0x30,0x37,0x31,0x33,0x31,0x32,0x31,0x32,0x32,0x39,0x5a,0x17,0x0d,0x30,0x39,0x30,0x38,0x31,0x32,0x31,0x32,0x31,0x32,0x32,0x39,0x5a,0x30,0x81,0x83,0x31,0x0b,0x30,0x09,0x06,0x03,0x55,0x04,0x06,0x13,0x02,0x46,0x52,0x31,0x0d,0x30,0x0b,0x06,0x03,0x55,0x04,0x08,0x0c,0x04,0x4e,0x4f,0x52,0x44,0x31,0x0e,0x30,0x0c,0x06,0x03,0x55,0x04,0x07,0x0c,0x05,0x4c,0x69,0x6c,0x6c,0x65,0x31,0x13,0x30,0x11,0x06,0x03,0x55,0x04,0x0a,0x0c,0x0a,0x49,0x4e,0x52,0x49,0x41,0x20,0x43,0x6f,0x72,0x70,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x0b,0x0c,0x09,0x74,0x6c,0x73,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x31,0x12,0x30,0x10,0x06,0x03,0x55,0x04,0x03,0x0c,0x09,0x74,0x6c,0x73,0x2e,0x6c,0x6f,0x63,0x61,0x6c,0x31,0x18,0x30,0x16,0x06,0x09,0x2a,0x86,0x48,0x86,0xf7,0x0d,0x01,0x09,0x01,0x16,0x09,0x6e,0x75,0x40,0x61,0x72,0x65,0x2e,0x72,0x6f,0x30,0x59,0x30,0x13,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x02,0x01,0x06,0x08,0x2a,0x86,0x48,0xce,0x3d,0x03,0x01,0x07,0x03,0x42,0x00,0x04,0x5b,0x5d,0xee,0x74,0xd4,0x63,0x63,0x2f,0x1c,0x19,0x8f,0xc0,0x7c,0x16,0x01,0x7b,0xa0,0x26,0xa5,0x2c,0x98,0x55,0xb3,0x2e,0xae,0x43,0xcc,0xee,0xe2,0xdf,0x6f,0x35,0xd6,0xfe,0x4f,0x9d,0x45,0x94,0x0d,0x16,0x2a,0x4d,0x35,0xff,0xbb,0x56,0x33,0x0e,0x52,0xb3,0x34,0x35,0x78,0xa9,0x60,0xa0,0x92,0xc4,0xe2,0xbb,0xdf,0xb8,0x0d,0x2f,0x30,0x09,0x06,0x07,0x2a,0x86,0x48,0xce,0x3d,0x04,0x01,0x03,0x47,0x00,0x30,0x44,0x02,0x20,0x3f,0xa0,0x76,0x48,0xd1,0xb8,0xde,0xa0,0x59,0x34,0xfb,0x21,0xc9,0x7b,0x56,0xd7,0x8a,0x31,0xbc,0x7f,0x62,0x9b,0x85,0x40,0xf7,0xf7,0x9b,0x82,0x93,0x26,0xc2,0x74,0x02,0x20,0x42,0x76,0x25,0xa7,0xba,0xd3,0x50,0x28,0x79,0xc2,0xf1,0xfe,0x14,0x4b,0x40,0x99,0x46,0x89,0xce,0xae,0xfd,0x69,0x0f,0x41,0x5b,0x24,0x8f,0x25,0xba,0xe0,0x6f,0xe7,0x0e,0x00,0x00,0x00,0x10,0x00,0x00,0x42,0x41,0x04,0x99,0xa3,0x2c,0x15,0x92,0x89,0x0f,0xad,0x1e,0x6c,0x98,0xf0,0xda,0x0b,0x24,0xb3,0x2a,0x37,0xb7,0x9f,0x48,0xe9,0x52,0x24,0x4e,0xd7,0x46,0xcb,0xe1,0xf1,0x18,0x3d,0xdf,0xe8,0x41,0xd5,0x92,0x17,0x99,0xe8,0xc4,0x8e,0x28,0x7c,0x4e,0x39,0x54,0x28,0x57,0x5c,0xc7,0x10,0x6d,0x07,0x03,0x06,0x99,0x5c,0xa2,0xc
0,0xc9,0x14,0x25,0xb0};
	for(i = 0; i < 800; i +=2)
		printf("0x%c%c,",string[i],string[i+1]);
	printf("\n");
	for(; i < 1618; i +=2)
		printf("0x%c%c,",string[i],string[i+1]);

	printf("\n");
	//String "Alex" to test

	struct md5_context md5;
	uint8_t data[32] = {0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78};
	uint8_t data2[33] = {0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x41,0x6c,0x65,0x78,0x78};
	uint8_t r[MD5_SIZE];

	md5_init(&md5);

	md5_update(&md5,data,32);

	md5_update(&md5,data2,33);

	md5_digest(&md5);

	for(i = 0 ; i < MD5_SIZE ; i++)
		printf("%02x",md5.buffer[i]);
	printf("\n");


	//answer : 1a9c7c8c06625f94243bf11707934bf9


}



*/

